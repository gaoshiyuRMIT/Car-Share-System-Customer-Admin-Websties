{% extends "navbar.html" %}
{% block title %}Browse Cars{% endblock %}

{% block scripts %}
    {{super()}}
    <script>
        function toggleVisibility(id) {
            const x = document.getElementById(id);
            if (x.style.display === "none") {
                x.style.display = "block";
            } else {
                x.style.display = "none";
            }
        }

        function toggleSearchForm() {
            toggleVisibility("search-form");
            const b = document.getElementById("toggle-form-button");
            if (b.innerHTML.trim() === "Search")
                b.innerHTML = "Hide";
            else
                b.innerHTML = "Search";
        }

        document.addEventListener('DOMContentLoaded', function(event) {
            toggleSearchForm();
        })
    </script>
{% endblock %}

{% block content %}
    <div class="container">
        <button onclick="toggleSearchForm()" id="toggle-form-button" class="btn btn-info btn-sm">Hide</button>
        <div class="row">
            <div class="col-md-12">
            <form method="post" action="{{ url_for('searchCars') }}" id="search-form">
                <div class="form-group">
                    <label class="control-label" for="car_id">Car ID</label>
                    <input class="form-control" type="number" id="car_id" name="car_id">
                </div>
                <div class="form-group">
                    <label class="control-label" for="year">Year</label>
                    <div id="year" class="input-group">
                        <div class="input-group-addon">from</div>
                        <input class="form-control col-3" type="number" id="year_from" min="1886" name="year_from">
                        <div class="input-group-addon">to</div>
                        <input class="form-control col-3" type="number" id="year_to" min="1886" name="year_to">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label" for="car_model">Car Model</label>
                    <input class="form-control" type="text" id="car_model" name="car_model">
                </div>
                <div class="form-group">
                    <label class="control-label" for="body_type">Body Type</label>
                    <input class="form-control" type="text" id="body_type" name="body_type">
                </div>
                <div class="form-group">
                    <label class="control-label" for="num_seats">Number of Seats</label>
                    <div id="num_seats" class="input-group">
                        <div class="input-group-addon">from</div>
                        <input class="form-control" type="number" id="num_seats_from" min="1" name="num_seats_from">
                        <div class="input-group-addon">to</div>
                        <input class="form-control" type="number" id="num_seats_to" max="12" name="num_seats_to">
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label" for="car_colour">Car Colour</label>
                    <input class="form-control" type="text" id="car_colour" name="car_colour">
                </div>
                <div class="form-group">
                    <label class="control-label" for="cost_hour">Cost per Hour</label>
                    <div id="cost_hour" class="input-group">
                        <div class="input-group-addon">from</div>
                        <input class="form-control" type="number" id="cost_hour_from" name="cost_hour_from" min="0.01" step="0.01">
                        <div class="input-group-addon">to</div>
                        <input class="form-control" type="number" id="cost_hour_to" name="cost_hour_to" min="0.01" step="0.01">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
            </div>
        </div>
        
        <div class='row'>
            <div class="col-md-12">
                <table class='table'>
                    <thead>
                        <tr>
                            <th>Car ID</th>
                            <th>Year</th>
                            <th>Model</th>
                            <th>Body Type</th>
                            <th>Number of Seats</th>
                            <th>Colour</th>
                            <th>Cost per Hour</th>
                            <th>Location(Coordinates)</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for car in cars %}
                        <tr>
                            <td>{{ car['car_id'] }}</td>
                            <td>{{ car['year'] }}</td>
                            <td>{{ car['car_model'] }}</td>
                            <td>{{ car['body_type'] }}</td>
                            <td>{{ car['num_seats'] }}</td>
                            <td>{{ car['car_colour'] }}</td>
                            <td>{{ car['cost_hour'] }}</td>
                            <td>{{ "{}, {}".format(car['latitude'], car['longitude']) }}
                                (<a href="#">Show on Map</a>)
                            </td>
                            <td>{{ car["car_status"] }}</td>
                            <td><a href="#">Book</a></td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}